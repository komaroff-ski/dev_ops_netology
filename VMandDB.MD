## Домашние задания по курсу DevOps (Нетология). Комаров С.Г.
## Блок Виртуализация, базы данных и Terraform

1. [Виртуализация](#vm)
 1.1 [Введение в виртуализацию](#vm_1)



## Виртуализация
<a name="vm"></a>

<a name="vm_1"></a>
#### Введение в виртуализацию
```
Задача 1
Опишите кратко, как вы поняли: в чем основное отличие полной (аппаратной) виртуализации, паравиртуализации и виртуализации на основе ОС.
```
Ответ:

Аппаратная или полная виртуализация - гипервизор устанавивается непосредственно на сервер и не требует дополнительной прослойи в виде базовой операционной системы. Пример: esxi, xen server, hyper-v core
Паравиртуализация - гипервизор устанавливаеся поверх базовой ОС. Примеры - VitrualBOX, WSL, KVM
Виртуализация уровня операционной системы - это использование механизма контейнеризации т.е. выделения изолированой среды выполнения с ограниченым кол-вом ресурсов для отдельных приложений, запущенных на одной ОС. Пример - Docker.

```
Задача 2
Выберите один из вариантов использования организации физических серверов, в зависимости от условий использования.

Организация серверов:

физические сервера,
паравиртуализация,
виртуализация уровня ОС.

Условия использования:

Высоконагруженная база данных, чувствительная к отказу.
Различные web-приложения.
Windows системы для использования бухгалтерским отделом.
Системы, выполняющие высокопроизводительные расчеты на GPU.
Опишите, почему вы выбрали к каждому целевому использованию такую организацию.
```

Ответ:

В общем случае, я бы старался избегать использования физических серверов вообще без виртуализации. 
Единственный оправданый на мой взгляд случай - построение кластера физических серверов для размещения высоконагруженной базы даных.

Различные web-приложения - используем аппаратную виртуализацию + виртуализацию уровня ОС, это наиболее экономичный и безопасный вариант.
Windows системы для использования бухгалтерским отделом - аппаратная или паравиртуализация. Контейнеры и windows - экзотика
Системы, выполняющие высокопроизводительные расчеты на GPU. - используем аппаратную + виртуализацию уровня ОС для того, чтбы иметь возможность распредетять ресурсы GPU по отдельным приложениям.

```
Задача 3
Выберите подходящую систему управления виртуализацией для предложенного сценария. Детально опишите ваш выбор.

Сценарии:

100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
Необходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.
```

Ответ:

Сценарий 1
100 виртуальных машин на базе Linux и Windows, общие задачи, нет особых требований. Преимущественно Windows based инфраструктура, требуется реализация программных балансировщиков нагрузки, репликации данных и автоматизированного механизма создания резервных копий.
VMWare VShpere + Veeam Backup. Считаю решение от VMWare наиболее зрелым для инфраструктур среднего и большого размера, хоть цена и кусается) В данном решении есть все необходимые инструменты. Для организации бэкапа я бы использовал veeam.

Сценарий 2
Требуется наиболее производительное бесплатное open source решение для виртуализации небольшой (20-30 серверов) инфраструктуры на базе Linux и Windows виртуальных машин.
В данном случае, из наиболее распространненных гипервизоров подходит только KVM т.к. все остальные либо не бесплатные либо не OpenSource

Сценарий 3
еобходимо бесплатное, максимально совместимое и производительное решение для виртуализации Windows инфраструктуры.
Тут подойдет Hyper-V Core, так же можно использовать и ХenServer в бесплатной редакции.

Необходимо рабочее окружение для тестирования программного продукта на нескольких дистрибутивах Linux.
Если тестирование не высоконагруженное, подойдет VirtualBox

```
Задача 4
Опишите возможные проблемы и недостатки гетерогенной среды виртуализации (использования нескольких систем управления виртуализацией одновременно) и что необходимо сделать для минимизации этих рисков и проблем. Если бы у вас был выбор, то создавали бы вы гетерогенную среду или нет? Мотивируйте ваш ответ примерами.
```

Проблем масса. Я бы стал использовать гетерогенную среду только в случае крайней необходимости.
1. Нужны специалисты по всем системам
2. Различные механизмы резервного копироваиня
3. Затруднена оперативная миграция с одного гипервизора на другой. Онлайн миграция - невозможна.
4. Построение кластеров для балансировки нагрузки и обеспечения отказоустойтивости - невозможно.

Меры по минмизации проблем:

- Использовать сторонний продукт для резервного копирования, совместимый со всем используемыми гипервизорами. Например Veeam умеет работать с ESXi и Hyper-V
- Использовать гипервизоры, для которых доступны конверторы VM из одного гипервизора в другой (например из VMWare в Hyper-V)
- Если это невозможно - строить паралельные полноценные отказоустойчивые инфраструктуры под каждый гипервизор (дорого!)
- По возможности - перейти на единый продукт.